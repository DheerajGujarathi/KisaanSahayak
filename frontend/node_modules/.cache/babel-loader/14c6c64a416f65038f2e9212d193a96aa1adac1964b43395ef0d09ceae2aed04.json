{"ast":null,"code":"var _jsxFileName = \"D:\\\\RAG-Farmers\\\\web-app\\\\frontend\\\\src\\\\components\\\\ChatInterface.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { FiSend, FiUser, FiMessageCircle, FiAlertCircle } from 'react-icons/fi';\nimport { chatService } from '../services/chatService';\nimport { userService } from '../services/userService';\nimport { chatHistoryService } from '../services/chatHistoryService';\nimport { v4 as uuidv4 } from 'uuid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatContainer = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  max-width: 800px;\n  margin: 0 auto;\n  padding: ${props => props.theme.spacing.md};\n  overflow: hidden; /* Prevent container overflow */\n`;\n_c = ChatContainer;\nconst MessagesContainer = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: ${props => props.theme.spacing.sm};\n  display: flex;\n  flex-direction: column;\n  gap: ${props => props.theme.spacing.sm};\n  min-height: 0; /* Ensures proper scrolling */\n`;\n_c2 = MessagesContainer;\nconst Message = styled.div`\n  display: flex;\n  gap: ${props => props.theme.spacing.sm};\n  align-items: flex-start;\n  opacity: ${props => props.isNew ? 0 : 1};\n  animation: ${props => props.isNew ? 'fadeIn 0.3s ease-out forwards' : 'none'};\n  width: 100%;\n  margin-bottom: ${props => props.theme.spacing.xs};\n  \n  ${props => props.isUser && `\n    flex-direction: row-reverse;\n    align-self: flex-end;\n  `}\n  \n  @keyframes fadeIn {\n    from { opacity: 0; transform: translateY(10px); }\n    to { opacity: 1; transform: translateY(0); }\n  }\n`;\n_c3 = Message;\nconst Avatar = styled.div`\n  width: 32px;\n  height: 32px;\n  border-radius: ${props => props.theme.borderRadius.full};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n  color: white;\n  font-size: ${props => props.theme.fontSizes.sm};\n  position: relative;\n  transition: all ${props => props.theme.transitions.fast};\n  \n  ${props => props.isUser ? `\n    background: ${props.theme.colors.primaryGradient};\n    box-shadow: 0 4px 15px rgba(46, 125, 50, 0.4);\n  ` : `\n    background: ${props.theme.colors.accentGradient};\n    box-shadow: 0 4px 15px rgba(0, 188, 212, 0.4);\n  `}\n  \n  &:hover {\n    transform: scale(1.1);\n    ${props => props.isUser ? `\n      box-shadow: 0 6px 20px rgba(46, 125, 50, 0.5);\n    ` : `\n      box-shadow: 0 6px 20px rgba(0, 188, 212, 0.5);\n    `}\n  }\n`;\n_c4 = Avatar;\nconst MessageBubble = styled.div`\n  max-width: 70%;\n  min-width: 80px;\n  padding: ${props => props.theme.spacing.sm} ${props => props.theme.spacing.md};\n  border-radius: ${props => props.theme.borderRadius.lg};\n  font-size: ${props => props.theme.fontSizes.base};\n  line-height: 1.4;\n  border: 2px solid;\n  word-wrap: break-word;\n  position: relative;\n  transition: all ${props => props.theme.transitions.fast};\n  \n  ${props => props.isUser ? `\n    background: ${props.theme.colors.primaryGradient};\n    color: white;\n    border-color: ${props.theme.colors.primaryLight};\n    border-bottom-right-radius: ${props.theme.borderRadius.sm};\n    box-shadow: 0 4px 20px rgba(46, 125, 50, 0.3);\n  ` : `\n    background: ${props.theme.colors.surfaceGradient};\n    color: ${props.theme.colors.text};\n    border-color: ${props.theme.colors.accentLight};\n    border-bottom-left-radius: ${props.theme.borderRadius.sm};\n    box-shadow: 0 4px 20px rgba(0, 188, 212, 0.15);\n  `}\n  \n  &:hover {\n    transform: translateY(-1px);\n    ${props => props.isUser ? `\n      box-shadow: 0 6px 25px rgba(46, 125, 50, 0.4);\n    ` : `\n      box-shadow: 0 6px 25px rgba(0, 188, 212, 0.2);\n    `}\n  }\n`;\n_c5 = MessageBubble;\nconst FormattedMessage = styled.div`\n  line-height: 1.6;\n  \n  h3 {\n    font-weight: 600;\n    font-size: ${props => props.theme.fontSizes.lg};\n    margin: ${props => props.theme.spacing.md} 0 ${props => props.theme.spacing.sm} 0;\n    color: ${props => props.theme.colors.primary};\n    \n    &:first-child {\n      margin-top: 0;\n    }\n  }\n  \n  h4 {\n    font-weight: 600;\n    font-size: ${props => props.theme.fontSizes.base};\n    margin: ${props => props.theme.spacing.sm} 0 ${props => props.theme.spacing.xs} 0;\n    color: ${props => props.theme.colors.textSecondary};\n  }\n  \n  ul {\n    margin: ${props => props.theme.spacing.xs} 0;\n    padding-left: ${props => props.theme.spacing.lg};\n    \n    li {\n      margin-bottom: ${props => props.theme.spacing.xs};\n      line-height: 1.5;\n    }\n  }\n  \n  p {\n    margin: ${props => props.theme.spacing.sm} 0;\n    \n    &:first-child {\n      margin-top: 0;\n    }\n    \n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n  \n  strong {\n    font-weight: 600;\n    color: ${props => props.theme.colors.primary};\n  }\n  \n  .section {\n    margin-bottom: ${props => props.theme.spacing.md};\n    \n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n`;\n_c6 = FormattedMessage;\nconst MessageTime = styled.div`\n  font-size: ${props => props.theme.fontSizes.xs};\n  color: ${props => props.isUser ? 'rgba(255,255,255,0.8)' : props.theme.colors.textSecondary};\n  margin-top: ${props => props.theme.spacing.xs};\n`;\n_c7 = MessageTime;\nconst InputContainer = styled.div`\n  display: flex;\n  gap: ${props => props.theme.spacing.sm};\n  padding: ${props => props.theme.spacing.md};\n  background: ${props => props.theme.colors.surfaceGradient};\n  border-radius: ${props => props.theme.borderRadius.lg};\n  border: 2px solid ${props => props.theme.colors.accentLight};\n  margin-top: ${props => props.theme.spacing.md};\n  box-shadow: 0 4px 20px rgba(0, 188, 212, 0.1);\n  transition: all ${props => props.theme.transitions.fast};\n  \n  &:focus-within {\n    border-color: ${props => props.theme.colors.accent};\n    box-shadow: 0 6px 30px rgba(0, 188, 212, 0.2);\n    transform: translateY(-1px);\n  }\n`;\n_c8 = InputContainer;\nconst MessageInput = styled.textarea`\n  flex: 1;\n  border: none;\n  background: transparent;\n  font-size: ${props => props.theme.fontSizes.base};\n  font-family: inherit;\n  color: ${props => props.theme.colors.text};\n  resize: none;\n  outline: none;\n  min-height: 20px;\n  max-height: 120px;\n  \n  &::placeholder {\n    color: ${props => props.theme.colors.textSecondary};\n  }\n`;\n_c9 = MessageInput;\nconst SendButton = styled.button`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 40px;\n  height: 40px;\n  border: none;\n  background: ${props => props.disabled ? props.theme.colors.borderLight : props.theme.colors.secondaryGradient};\n  color: white;\n  border-radius: ${props => props.theme.borderRadius.lg};\n  cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\n  transition: all ${props => props.theme.transitions.fast};\n  box-shadow: 0 4px 15px rgba(255, 143, 0, 0.3);\n  \n  &:hover:not(:disabled) {\n    background: ${props => props.theme.colors.secondaryDark};\n    transform: translateY(-2px);\n    box-shadow: 0 6px 20px rgba(255, 143, 0, 0.4);\n  }\n  \n  &:active:not(:disabled) {\n    transform: translateY(0);\n  }\n`;\n_c0 = SendButton;\nconst TypingIndicator = styled.div`\n  display: flex;\n  gap: ${props => props.theme.spacing.sm};\n  align-items: center;\n  padding: ${props => props.theme.spacing.md};\n  background: ${props => props.theme.colors.surface};\n  border: 1px solid ${props => props.theme.colors.border};\n  border-radius: ${props => props.theme.borderRadius.lg};\n  border-bottom-left-radius: ${props => props.theme.borderRadius.sm};\n  color: ${props => props.theme.colors.textSecondary};\n  font-style: italic;\n  \n  .dots {\n    display: flex;\n    gap: 2px;\n  }\n  \n  .dot {\n    width: 4px;\n    height: 4px;\n    background: ${props => props.theme.colors.textSecondary};\n    border-radius: 50%;\n    animation: pulse 1.4s ease-in-out infinite both;\n  }\n  \n  .dot:nth-child(1) { animation-delay: -0.32s; }\n  .dot:nth-child(2) { animation-delay: -0.16s; }\n`;\n_c1 = TypingIndicator;\nconst ErrorMessage = styled.div`\n  display: flex;\n  align-items: center;\n  gap: ${props => props.theme.spacing.sm};\n  padding: ${props => props.theme.spacing.md};\n  background: ${props => props.theme.colors.error}10;\n  border: 1px solid ${props => props.theme.colors.error}30;\n  border-radius: ${props => props.theme.borderRadius.md};\n  color: ${props => props.theme.colors.error};\n  font-size: ${props => props.theme.fontSizes.sm};\n  margin-top: ${props => props.theme.spacing.sm};\n`;\n_c10 = ErrorMessage;\nconst WelcomeMessage = styled.div`\n  text-align: center;\n  padding: ${props => props.theme.spacing.xl};\n  color: ${props => props.theme.colors.textSecondary};\n  background: ${props => props.theme.colors.surfaceGradient};\n  border-radius: ${props => props.theme.borderRadius.xl};\n  margin: ${props => props.theme.spacing.lg};\n  box-shadow: ${props => props.theme.colors.cardShadow};\n  position: relative;\n  overflow: hidden;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 4px;\n    background: ${props => props.theme.colors.accentGradient};\n  }\n  \n  h2 {\n    font-size: ${props => props.theme.fontSizes['3xl']};\n    background: ${props => props.theme.colors.primaryGradient};\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    margin-bottom: ${props => props.theme.spacing.md};\n    font-weight: ${props => props.theme.fontWeights.bold};\n    \n    @supports not (-webkit-background-clip: text) {\n      color: ${props => props.theme.colors.primary};\n    }\n  }\n  \n  p {\n    font-size: ${props => props.theme.fontSizes.lg};\n    margin-bottom: ${props => props.theme.spacing.lg};\n    color: ${props => props.theme.colors.textSecondary};\n  }\n  \n  .examples {\n    display: flex;\n    flex-direction: column;\n    gap: ${props => props.theme.spacing.sm};\n    max-width: 500px;\n    margin: 0 auto;\n  }\n`;\n_c11 = WelcomeMessage;\nconst ExampleQuery = styled.button`\n  padding: ${props => props.theme.spacing.md} ${props => props.theme.spacing.lg};\n  border: 2px solid transparent;\n  background: ${props => props.theme.colors.surfaceGradient};\n  border-radius: ${props => props.theme.borderRadius.lg};\n  color: ${props => props.theme.colors.text};\n  cursor: pointer;\n  font-size: ${props => props.theme.fontSizes.base};\n  font-weight: ${props => props.theme.fontWeights.medium};\n  transition: all ${props => props.theme.transitions.fast};\n  box-shadow: 0 4px 15px rgba(0, 188, 212, 0.1);\n  position: relative;\n  overflow: hidden;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: ${props => props.theme.colors.accentGradient};\n    transition: left ${props => props.theme.transitions.normal};\n    z-index: -1;\n  }\n  \n  &:hover {\n    border-color: ${props => props.theme.colors.accent};\n    color: white;\n    transform: translateY(-2px);\n    box-shadow: 0 8px 25px rgba(0, 188, 212, 0.3);\n    \n    &::before {\n      left: 0;\n    }\n  }\n`;\n\n// Function to format bot responses with better readability\n_c12 = ExampleQuery;\nconst formatBotResponse = text => {\n  if (!text) return text;\n  let formatted = text;\n\n  // Convert **Section:** to headers\n  formatted = formatted.replace(/\\*\\*([^*:]+):\\*\\*/g, '<h4>$1:</h4>');\n\n  // Convert bold text\n  formatted = formatted.replace(/\\*\\*([^*]+)\\*\\*/g, '<strong>$1</strong>');\n\n  // Split into lines and process\n  const lines = formatted.split('\\n').filter(line => line.trim());\n  let result = [];\n  let currentList = [];\n  lines.forEach((line, index) => {\n    const trimmed = line.trim();\n\n    // Handle headers\n    if (trimmed.includes('<h4>')) {\n      // Close any open list\n      if (currentList.length > 0) {\n        result.push(`<ul>${currentList.join('')}</ul>`);\n        currentList = [];\n      }\n      result.push(`<div class=\"section\">${trimmed}</div>`);\n      return;\n    }\n\n    // Handle numbered items (1. 2. etc.)\n    if (/^\\d+\\.\\s+/.test(trimmed)) {\n      const content = trimmed.replace(/^\\d+\\.\\s+/, '');\n      currentList.push(`<li>${content}</li>`);\n      return;\n    }\n\n    // Handle bullet points\n    if (trimmed.startsWith('•') || trimmed.startsWith('-') || trimmed.startsWith('*')) {\n      const content = trimmed.substring(1).trim();\n      currentList.push(`<li>${content}</li>`);\n      return;\n    }\n\n    // Regular paragraph\n    if (trimmed) {\n      // Close any open list\n      if (currentList.length > 0) {\n        result.push(`<ul>${currentList.join('')}</ul>`);\n        currentList = [];\n      }\n      result.push(`<p>${trimmed}</p>`);\n    }\n  });\n\n  // Close any remaining list\n  if (currentList.length > 0) {\n    result.push(`<ul>${currentList.join('')}</ul>`);\n  }\n  return result.join('');\n};\nfunction ChatInterface({\n  initialMessages = [],\n  sessionId: propSessionId,\n  onMessagesChange\n}) {\n  _s();\n  const [messages, setMessages] = useState(initialMessages);\n  const [inputValue, setInputValue] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [sessionId] = useState(() => propSessionId || uuidv4());\n  const [currentUser] = useState(() => userService.getCurrentUser());\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n\n  // Update messages when initialMessages prop changes\n  useEffect(() => {\n    setMessages(initialMessages);\n  }, [initialMessages]);\n\n  // Notify parent component when messages change\n  useEffect(() => {\n    if (onMessagesChange) {\n      onMessagesChange(messages);\n    }\n  }, [messages, onMessagesChange]);\n\n  // Load chat history on component mount (only if no initial messages)\n  useEffect(() => {\n    if (initialMessages.length === 0) {\n      const loadChatHistory = () => {\n        try {\n          const history = chatHistoryService.loadChatHistory();\n          if (history.length > 0) {\n            setMessages(history);\n          }\n        } catch (error) {\n          console.error('Failed to load chat history:', error);\n        }\n      };\n      loadChatHistory();\n    }\n  }, [initialMessages.length]);\n\n  // Save messages to history whenever messages change\n  useEffect(() => {\n    if (messages.length > 0) {\n      chatHistoryService.saveChatHistory(messages);\n    }\n  }, [messages]);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  const formatTime = date => {\n    return new Intl.DateTimeFormat('en-US', {\n      hour: '2-digit',\n      minute: '2-digit'\n    }).format(date);\n  };\n  const sendMessage = async (messageText = inputValue.trim()) => {\n    if (!messageText || isLoading) return;\n    const userMessage = {\n      id: uuidv4(),\n      text: messageText,\n      isUser: true,\n      timestamp: new Date(),\n      isNew: true\n    };\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await chatService.sendMessage(messageText, sessionId, currentUser.id);\n      const assistantMessage = {\n        id: uuidv4(),\n        text: response.message,\n        isUser: false,\n        timestamp: new Date(),\n        type: response.type,\n        isNew: true\n      };\n      setMessages(prev => [...prev, assistantMessage]);\n    } catch (err) {\n      console.error('Chat error:', err);\n      setError(err.message || 'Failed to send message');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n  const handleInputChange = e => {\n    setInputValue(e.target.value);\n\n    // Auto-resize textarea\n    e.target.style.height = 'auto';\n    e.target.style.height = e.target.scrollHeight + 'px';\n  };\n  const exampleQueries = [\"What's the best time to plant tomatoes?\", \"How do I control pests in my corn crop?\", \"What fertilizer should I use for wheat?\", \"Tell me about soil preparation\"];\n  return /*#__PURE__*/_jsxDEV(ChatContainer, {\n    children: [/*#__PURE__*/_jsxDEV(MessagesContainer, {\n      children: [messages.length === 0 ? /*#__PURE__*/_jsxDEV(WelcomeMessage, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Welcome to KisaanSahayak! \\uD83C\\uDF3E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"I'm here to help with all your farming and agriculture questions.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 563,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"examples\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Try asking about:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 565,\n            columnNumber: 15\n          }, this), exampleQueries.map((query, index) => /*#__PURE__*/_jsxDEV(ExampleQuery, {\n            onClick: () => sendMessage(query),\n            children: query\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 567,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 564,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 561,\n        columnNumber: 11\n      }, this) : messages.map(message => /*#__PURE__*/_jsxDEV(Message, {\n        isUser: message.isUser,\n        isNew: message.isNew,\n        children: [/*#__PURE__*/_jsxDEV(Avatar, {\n          isUser: message.isUser,\n          children: message.isUser ? /*#__PURE__*/_jsxDEV(FiUser, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 35\n          }, this) : /*#__PURE__*/_jsxDEV(FiMessageCircle, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 48\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(MessageBubble, {\n            isUser: message.isUser,\n            children: message.isUser ? message.text : /*#__PURE__*/_jsxDEV(FormattedMessage, {\n              dangerouslySetInnerHTML: {\n                __html: formatBotResponse(message.text)\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 587,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 583,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(MessageTime, {\n            isUser: message.isUser,\n            children: formatTime(message.timestamp)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 594,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 582,\n          columnNumber: 15\n        }, this)]\n      }, message.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 578,\n        columnNumber: 13\n      }, this)), isLoading && /*#__PURE__*/_jsxDEV(Message, {\n        isUser: false,\n        children: [/*#__PURE__*/_jsxDEV(Avatar, {\n          isUser: false,\n          children: /*#__PURE__*/_jsxDEV(FiMessageCircle, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 605,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 604,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(TypingIndicator, {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"AI is thinking\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 608,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"dots\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 610,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 611,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 612,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 609,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 607,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 603,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 618,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 559,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(ErrorMessage, {\n      children: [/*#__PURE__*/_jsxDEV(FiAlertCircle, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 623,\n        columnNumber: 11\n      }, this), error]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 622,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(InputContainer, {\n      children: [/*#__PURE__*/_jsxDEV(MessageInput, {\n        ref: inputRef,\n        value: inputValue,\n        onChange: handleInputChange,\n        onKeyPress: handleKeyPress,\n        placeholder: \"Ask me anything about farming...\",\n        disabled: isLoading,\n        rows: \"1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 629,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SendButton, {\n        onClick: () => sendMessage(),\n        disabled: !inputValue.trim() || isLoading,\n        children: /*#__PURE__*/_jsxDEV(FiSend, {\n          size: 16\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 642,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 638,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 628,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 558,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatInterface, \"BK1FrD35ig6mCkijlTzs80mfKXA=\");\n_c13 = ChatInterface;\nexport default ChatInterface;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1, _c10, _c11, _c12, _c13;\n$RefreshReg$(_c, \"ChatContainer\");\n$RefreshReg$(_c2, \"MessagesContainer\");\n$RefreshReg$(_c3, \"Message\");\n$RefreshReg$(_c4, \"Avatar\");\n$RefreshReg$(_c5, \"MessageBubble\");\n$RefreshReg$(_c6, \"FormattedMessage\");\n$RefreshReg$(_c7, \"MessageTime\");\n$RefreshReg$(_c8, \"InputContainer\");\n$RefreshReg$(_c9, \"MessageInput\");\n$RefreshReg$(_c0, \"SendButton\");\n$RefreshReg$(_c1, \"TypingIndicator\");\n$RefreshReg$(_c10, \"ErrorMessage\");\n$RefreshReg$(_c11, \"WelcomeMessage\");\n$RefreshReg$(_c12, \"ExampleQuery\");\n$RefreshReg$(_c13, \"ChatInterface\");","map":{"version":3,"names":["React","useState","useRef","useEffect","styled","FiSend","FiUser","FiMessageCircle","FiAlertCircle","chatService","userService","chatHistoryService","v4","uuidv4","jsxDEV","_jsxDEV","ChatContainer","div","props","theme","spacing","md","_c","MessagesContainer","sm","_c2","Message","isNew","xs","isUser","_c3","Avatar","borderRadius","full","fontSizes","transitions","fast","colors","primaryGradient","accentGradient","_c4","MessageBubble","lg","base","primaryLight","surfaceGradient","text","accentLight","_c5","FormattedMessage","primary","textSecondary","_c6","MessageTime","_c7","InputContainer","accent","_c8","MessageInput","textarea","_c9","SendButton","button","disabled","borderLight","secondaryGradient","secondaryDark","_c0","TypingIndicator","surface","border","_c1","ErrorMessage","error","_c10","WelcomeMessage","xl","cardShadow","fontWeights","bold","_c11","ExampleQuery","medium","normal","_c12","formatBotResponse","formatted","replace","lines","split","filter","line","trim","result","currentList","forEach","index","trimmed","includes","length","push","join","test","content","startsWith","substring","ChatInterface","initialMessages","sessionId","propSessionId","onMessagesChange","_s","messages","setMessages","inputValue","setInputValue","isLoading","setIsLoading","setError","currentUser","getCurrentUser","messagesEndRef","inputRef","loadChatHistory","history","console","saveChatHistory","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","formatTime","date","Intl","DateTimeFormat","hour","minute","format","sendMessage","messageText","userMessage","id","timestamp","Date","prev","response","assistantMessage","message","type","err","handleKeyPress","e","key","shiftKey","preventDefault","handleInputChange","target","value","style","height","scrollHeight","exampleQueries","children","fileName","_jsxFileName","lineNumber","columnNumber","className","map","query","onClick","dangerouslySetInnerHTML","__html","ref","onChange","onKeyPress","placeholder","rows","size","_c13","$RefreshReg$"],"sources":["D:/RAG-Farmers/web-app/frontend/src/components/ChatInterface.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport styled from 'styled-components';\r\nimport { FiSend, FiUser, FiMessageCircle, FiAlertCircle } from 'react-icons/fi';\r\nimport { chatService } from '../services/chatService';\r\nimport { userService } from '../services/userService';\r\nimport { chatHistoryService } from '../services/chatHistoryService';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nconst ChatContainer = styled.div`\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  padding: ${props => props.theme.spacing.md};\r\n  overflow: hidden; /* Prevent container overflow */\r\n`;\r\n\r\nconst MessagesContainer = styled.div`\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: ${props => props.theme.spacing.sm};\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: ${props => props.theme.spacing.sm};\r\n  min-height: 0; /* Ensures proper scrolling */\r\n`;\r\n\r\nconst Message = styled.div`\r\n  display: flex;\r\n  gap: ${props => props.theme.spacing.sm};\r\n  align-items: flex-start;\r\n  opacity: ${props => props.isNew ? 0 : 1};\r\n  animation: ${props => props.isNew ? 'fadeIn 0.3s ease-out forwards' : 'none'};\r\n  width: 100%;\r\n  margin-bottom: ${props => props.theme.spacing.xs};\r\n  \r\n  ${props => props.isUser && `\r\n    flex-direction: row-reverse;\r\n    align-self: flex-end;\r\n  `}\r\n  \r\n  @keyframes fadeIn {\r\n    from { opacity: 0; transform: translateY(10px); }\r\n    to { opacity: 1; transform: translateY(0); }\r\n  }\r\n`;\r\n\r\nconst Avatar = styled.div`\r\n  width: 32px;\r\n  height: 32px;\r\n  border-radius: ${props => props.theme.borderRadius.full};\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-shrink: 0;\r\n  color: white;\r\n  font-size: ${props => props.theme.fontSizes.sm};\r\n  position: relative;\r\n  transition: all ${props => props.theme.transitions.fast};\r\n  \r\n  ${props => props.isUser ? `\r\n    background: ${props.theme.colors.primaryGradient};\r\n    box-shadow: 0 4px 15px rgba(46, 125, 50, 0.4);\r\n  ` : `\r\n    background: ${props.theme.colors.accentGradient};\r\n    box-shadow: 0 4px 15px rgba(0, 188, 212, 0.4);\r\n  `}\r\n  \r\n  &:hover {\r\n    transform: scale(1.1);\r\n    ${props => props.isUser ? `\r\n      box-shadow: 0 6px 20px rgba(46, 125, 50, 0.5);\r\n    ` : `\r\n      box-shadow: 0 6px 20px rgba(0, 188, 212, 0.5);\r\n    `}\r\n  }\r\n`;\r\n\r\nconst MessageBubble = styled.div`\r\n  max-width: 70%;\r\n  min-width: 80px;\r\n  padding: ${props => props.theme.spacing.sm} ${props => props.theme.spacing.md};\r\n  border-radius: ${props => props.theme.borderRadius.lg};\r\n  font-size: ${props => props.theme.fontSizes.base};\r\n  line-height: 1.4;\r\n  border: 2px solid;\r\n  word-wrap: break-word;\r\n  position: relative;\r\n  transition: all ${props => props.theme.transitions.fast};\r\n  \r\n  ${props => props.isUser ? `\r\n    background: ${props.theme.colors.primaryGradient};\r\n    color: white;\r\n    border-color: ${props.theme.colors.primaryLight};\r\n    border-bottom-right-radius: ${props.theme.borderRadius.sm};\r\n    box-shadow: 0 4px 20px rgba(46, 125, 50, 0.3);\r\n  ` : `\r\n    background: ${props.theme.colors.surfaceGradient};\r\n    color: ${props.theme.colors.text};\r\n    border-color: ${props.theme.colors.accentLight};\r\n    border-bottom-left-radius: ${props.theme.borderRadius.sm};\r\n    box-shadow: 0 4px 20px rgba(0, 188, 212, 0.15);\r\n  `}\r\n  \r\n  &:hover {\r\n    transform: translateY(-1px);\r\n    ${props => props.isUser ? `\r\n      box-shadow: 0 6px 25px rgba(46, 125, 50, 0.4);\r\n    ` : `\r\n      box-shadow: 0 6px 25px rgba(0, 188, 212, 0.2);\r\n    `}\r\n  }\r\n`;\r\n\r\nconst FormattedMessage = styled.div`\r\n  line-height: 1.6;\r\n  \r\n  h3 {\r\n    font-weight: 600;\r\n    font-size: ${props => props.theme.fontSizes.lg};\r\n    margin: ${props => props.theme.spacing.md} 0 ${props => props.theme.spacing.sm} 0;\r\n    color: ${props => props.theme.colors.primary};\r\n    \r\n    &:first-child {\r\n      margin-top: 0;\r\n    }\r\n  }\r\n  \r\n  h4 {\r\n    font-weight: 600;\r\n    font-size: ${props => props.theme.fontSizes.base};\r\n    margin: ${props => props.theme.spacing.sm} 0 ${props => props.theme.spacing.xs} 0;\r\n    color: ${props => props.theme.colors.textSecondary};\r\n  }\r\n  \r\n  ul {\r\n    margin: ${props => props.theme.spacing.xs} 0;\r\n    padding-left: ${props => props.theme.spacing.lg};\r\n    \r\n    li {\r\n      margin-bottom: ${props => props.theme.spacing.xs};\r\n      line-height: 1.5;\r\n    }\r\n  }\r\n  \r\n  p {\r\n    margin: ${props => props.theme.spacing.sm} 0;\r\n    \r\n    &:first-child {\r\n      margin-top: 0;\r\n    }\r\n    \r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n  \r\n  strong {\r\n    font-weight: 600;\r\n    color: ${props => props.theme.colors.primary};\r\n  }\r\n  \r\n  .section {\r\n    margin-bottom: ${props => props.theme.spacing.md};\r\n    \r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n`;\r\n\r\nconst MessageTime = styled.div`\r\n  font-size: ${props => props.theme.fontSizes.xs};\r\n  color: ${props => props.isUser ? 'rgba(255,255,255,0.8)' : props.theme.colors.textSecondary};\r\n  margin-top: ${props => props.theme.spacing.xs};\r\n`;\r\n\r\nconst InputContainer = styled.div`\r\n  display: flex;\r\n  gap: ${props => props.theme.spacing.sm};\r\n  padding: ${props => props.theme.spacing.md};\r\n  background: ${props => props.theme.colors.surfaceGradient};\r\n  border-radius: ${props => props.theme.borderRadius.lg};\r\n  border: 2px solid ${props => props.theme.colors.accentLight};\r\n  margin-top: ${props => props.theme.spacing.md};\r\n  box-shadow: 0 4px 20px rgba(0, 188, 212, 0.1);\r\n  transition: all ${props => props.theme.transitions.fast};\r\n  \r\n  &:focus-within {\r\n    border-color: ${props => props.theme.colors.accent};\r\n    box-shadow: 0 6px 30px rgba(0, 188, 212, 0.2);\r\n    transform: translateY(-1px);\r\n  }\r\n`;\r\n\r\nconst MessageInput = styled.textarea`\r\n  flex: 1;\r\n  border: none;\r\n  background: transparent;\r\n  font-size: ${props => props.theme.fontSizes.base};\r\n  font-family: inherit;\r\n  color: ${props => props.theme.colors.text};\r\n  resize: none;\r\n  outline: none;\r\n  min-height: 20px;\r\n  max-height: 120px;\r\n  \r\n  &::placeholder {\r\n    color: ${props => props.theme.colors.textSecondary};\r\n  }\r\n`;\r\n\r\nconst SendButton = styled.button`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 40px;\r\n  height: 40px;\r\n  border: none;\r\n  background: ${props => props.disabled ? \r\n    props.theme.colors.borderLight : \r\n    props.theme.colors.secondaryGradient};\r\n  color: white;\r\n  border-radius: ${props => props.theme.borderRadius.lg};\r\n  cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\r\n  transition: all ${props => props.theme.transitions.fast};\r\n  box-shadow: 0 4px 15px rgba(255, 143, 0, 0.3);\r\n  \r\n  &:hover:not(:disabled) {\r\n    background: ${props => props.theme.colors.secondaryDark};\r\n    transform: translateY(-2px);\r\n    box-shadow: 0 6px 20px rgba(255, 143, 0, 0.4);\r\n  }\r\n  \r\n  &:active:not(:disabled) {\r\n    transform: translateY(0);\r\n  }\r\n`;\r\n\r\nconst TypingIndicator = styled.div`\r\n  display: flex;\r\n  gap: ${props => props.theme.spacing.sm};\r\n  align-items: center;\r\n  padding: ${props => props.theme.spacing.md};\r\n  background: ${props => props.theme.colors.surface};\r\n  border: 1px solid ${props => props.theme.colors.border};\r\n  border-radius: ${props => props.theme.borderRadius.lg};\r\n  border-bottom-left-radius: ${props => props.theme.borderRadius.sm};\r\n  color: ${props => props.theme.colors.textSecondary};\r\n  font-style: italic;\r\n  \r\n  .dots {\r\n    display: flex;\r\n    gap: 2px;\r\n  }\r\n  \r\n  .dot {\r\n    width: 4px;\r\n    height: 4px;\r\n    background: ${props => props.theme.colors.textSecondary};\r\n    border-radius: 50%;\r\n    animation: pulse 1.4s ease-in-out infinite both;\r\n  }\r\n  \r\n  .dot:nth-child(1) { animation-delay: -0.32s; }\r\n  .dot:nth-child(2) { animation-delay: -0.16s; }\r\n`;\r\n\r\nconst ErrorMessage = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: ${props => props.theme.spacing.sm};\r\n  padding: ${props => props.theme.spacing.md};\r\n  background: ${props => props.theme.colors.error}10;\r\n  border: 1px solid ${props => props.theme.colors.error}30;\r\n  border-radius: ${props => props.theme.borderRadius.md};\r\n  color: ${props => props.theme.colors.error};\r\n  font-size: ${props => props.theme.fontSizes.sm};\r\n  margin-top: ${props => props.theme.spacing.sm};\r\n`;\r\n\r\nconst WelcomeMessage = styled.div`\r\n  text-align: center;\r\n  padding: ${props => props.theme.spacing.xl};\r\n  color: ${props => props.theme.colors.textSecondary};\r\n  background: ${props => props.theme.colors.surfaceGradient};\r\n  border-radius: ${props => props.theme.borderRadius.xl};\r\n  margin: ${props => props.theme.spacing.lg};\r\n  box-shadow: ${props => props.theme.colors.cardShadow};\r\n  position: relative;\r\n  overflow: hidden;\r\n  \r\n  &::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    height: 4px;\r\n    background: ${props => props.theme.colors.accentGradient};\r\n  }\r\n  \r\n  h2 {\r\n    font-size: ${props => props.theme.fontSizes['3xl']};\r\n    background: ${props => props.theme.colors.primaryGradient};\r\n    -webkit-background-clip: text;\r\n    -webkit-text-fill-color: transparent;\r\n    background-clip: text;\r\n    margin-bottom: ${props => props.theme.spacing.md};\r\n    font-weight: ${props => props.theme.fontWeights.bold};\r\n    \r\n    @supports not (-webkit-background-clip: text) {\r\n      color: ${props => props.theme.colors.primary};\r\n    }\r\n  }\r\n  \r\n  p {\r\n    font-size: ${props => props.theme.fontSizes.lg};\r\n    margin-bottom: ${props => props.theme.spacing.lg};\r\n    color: ${props => props.theme.colors.textSecondary};\r\n  }\r\n  \r\n  .examples {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: ${props => props.theme.spacing.sm};\r\n    max-width: 500px;\r\n    margin: 0 auto;\r\n  }\r\n`;\r\n\r\nconst ExampleQuery = styled.button`\r\n  padding: ${props => props.theme.spacing.md} ${props => props.theme.spacing.lg};\r\n  border: 2px solid transparent;\r\n  background: ${props => props.theme.colors.surfaceGradient};\r\n  border-radius: ${props => props.theme.borderRadius.lg};\r\n  color: ${props => props.theme.colors.text};\r\n  cursor: pointer;\r\n  font-size: ${props => props.theme.fontSizes.base};\r\n  font-weight: ${props => props.theme.fontWeights.medium};\r\n  transition: all ${props => props.theme.transitions.fast};\r\n  box-shadow: 0 4px 15px rgba(0, 188, 212, 0.1);\r\n  position: relative;\r\n  overflow: hidden;\r\n  \r\n  &::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: 0;\r\n    left: -100%;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: ${props => props.theme.colors.accentGradient};\r\n    transition: left ${props => props.theme.transitions.normal};\r\n    z-index: -1;\r\n  }\r\n  \r\n  &:hover {\r\n    border-color: ${props => props.theme.colors.accent};\r\n    color: white;\r\n    transform: translateY(-2px);\r\n    box-shadow: 0 8px 25px rgba(0, 188, 212, 0.3);\r\n    \r\n    &::before {\r\n      left: 0;\r\n    }\r\n  }\r\n`;\r\n\r\n// Function to format bot responses with better readability\r\nconst formatBotResponse = (text) => {\r\n  if (!text) return text;\r\n  \r\n  let formatted = text;\r\n  \r\n  // Convert **Section:** to headers\r\n  formatted = formatted.replace(/\\*\\*([^*:]+):\\*\\*/g, '<h4>$1:</h4>');\r\n  \r\n  // Convert bold text\r\n  formatted = formatted.replace(/\\*\\*([^*]+)\\*\\*/g, '<strong>$1</strong>');\r\n  \r\n  // Split into lines and process\r\n  const lines = formatted.split('\\n').filter(line => line.trim());\r\n  let result = [];\r\n  let currentList = [];\r\n  \r\n  lines.forEach((line, index) => {\r\n    const trimmed = line.trim();\r\n    \r\n    // Handle headers\r\n    if (trimmed.includes('<h4>')) {\r\n      // Close any open list\r\n      if (currentList.length > 0) {\r\n        result.push(`<ul>${currentList.join('')}</ul>`);\r\n        currentList = [];\r\n      }\r\n      result.push(`<div class=\"section\">${trimmed}</div>`);\r\n      return;\r\n    }\r\n    \r\n    // Handle numbered items (1. 2. etc.)\r\n    if (/^\\d+\\.\\s+/.test(trimmed)) {\r\n      const content = trimmed.replace(/^\\d+\\.\\s+/, '');\r\n      currentList.push(`<li>${content}</li>`);\r\n      return;\r\n    }\r\n    \r\n    // Handle bullet points\r\n    if (trimmed.startsWith('•') || trimmed.startsWith('-') || trimmed.startsWith('*')) {\r\n      const content = trimmed.substring(1).trim();\r\n      currentList.push(`<li>${content}</li>`);\r\n      return;\r\n    }\r\n    \r\n    // Regular paragraph\r\n    if (trimmed) {\r\n      // Close any open list\r\n      if (currentList.length > 0) {\r\n        result.push(`<ul>${currentList.join('')}</ul>`);\r\n        currentList = [];\r\n      }\r\n      result.push(`<p>${trimmed}</p>`);\r\n    }\r\n  });\r\n  \r\n  // Close any remaining list\r\n  if (currentList.length > 0) {\r\n    result.push(`<ul>${currentList.join('')}</ul>`);\r\n  }\r\n  \r\n  return result.join('');\r\n};\r\n\r\nfunction ChatInterface({ initialMessages = [], sessionId: propSessionId, onMessagesChange }) {\r\n  const [messages, setMessages] = useState(initialMessages);\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [sessionId] = useState(() => propSessionId || uuidv4());\r\n  const [currentUser] = useState(() => userService.getCurrentUser());\r\n  const messagesEndRef = useRef(null);\r\n  const inputRef = useRef(null);\r\n\r\n  // Update messages when initialMessages prop changes\r\n  useEffect(() => {\r\n    setMessages(initialMessages);\r\n  }, [initialMessages]);\r\n\r\n  // Notify parent component when messages change\r\n  useEffect(() => {\r\n    if (onMessagesChange) {\r\n      onMessagesChange(messages);\r\n    }\r\n  }, [messages, onMessagesChange]);\r\n\r\n  // Load chat history on component mount (only if no initial messages)\r\n  useEffect(() => {\r\n    if (initialMessages.length === 0) {\r\n      const loadChatHistory = () => {\r\n        try {\r\n          const history = chatHistoryService.loadChatHistory();\r\n          if (history.length > 0) {\r\n            setMessages(history);\r\n          }\r\n        } catch (error) {\r\n          console.error('Failed to load chat history:', error);\r\n        }\r\n      };\r\n\r\n      loadChatHistory();\r\n    }\r\n  }, [initialMessages.length]);\r\n\r\n  // Save messages to history whenever messages change\r\n  useEffect(() => {\r\n    if (messages.length > 0) {\r\n      chatHistoryService.saveChatHistory(messages);\r\n    }\r\n  }, [messages]);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const formatTime = (date) => {\r\n    return new Intl.DateTimeFormat('en-US', {\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n    }).format(date);\r\n  };\r\n\r\n  const sendMessage = async (messageText = inputValue.trim()) => {\r\n    if (!messageText || isLoading) return;\r\n\r\n    const userMessage = {\r\n      id: uuidv4(),\r\n      text: messageText,\r\n      isUser: true,\r\n      timestamp: new Date(),\r\n      isNew: true,\r\n    };\r\n\r\n    setMessages(prev => [...prev, userMessage]);\r\n    setInputValue('');\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await chatService.sendMessage(messageText, sessionId, currentUser.id);\r\n      \r\n      const assistantMessage = {\r\n        id: uuidv4(),\r\n        text: response.message,\r\n        isUser: false,\r\n        timestamp: new Date(),\r\n        type: response.type,\r\n        isNew: true,\r\n      };\r\n\r\n      setMessages(prev => [...prev, assistantMessage]);\r\n    } catch (err) {\r\n      console.error('Chat error:', err);\r\n      setError(err.message || 'Failed to send message');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      sendMessage();\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    setInputValue(e.target.value);\r\n    \r\n    // Auto-resize textarea\r\n    e.target.style.height = 'auto';\r\n    e.target.style.height = e.target.scrollHeight + 'px';\r\n  };\r\n\r\n  const exampleQueries = [\r\n    \"What's the best time to plant tomatoes?\",\r\n    \"How do I control pests in my corn crop?\",\r\n    \"What fertilizer should I use for wheat?\",\r\n    \"Tell me about soil preparation\"\r\n  ];\r\n\r\n  return (\r\n    <ChatContainer>\r\n      <MessagesContainer>\r\n        {messages.length === 0 ? (\r\n          <WelcomeMessage>\r\n            <h2>Welcome to KisaanSahayak! 🌾</h2>\r\n            <p>I'm here to help with all your farming and agriculture questions.</p>\r\n            <div className=\"examples\">\r\n              <strong>Try asking about:</strong>\r\n              {exampleQueries.map((query, index) => (\r\n                <ExampleQuery\r\n                  key={index}\r\n                  onClick={() => sendMessage(query)}\r\n                >\r\n                  {query}\r\n                </ExampleQuery>\r\n              ))}\r\n            </div>\r\n          </WelcomeMessage>\r\n        ) : (\r\n          messages.map(message => (\r\n            <Message key={message.id} isUser={message.isUser} isNew={message.isNew}>\r\n              <Avatar isUser={message.isUser}>\r\n                {message.isUser ? <FiUser /> : <FiMessageCircle />}\r\n              </Avatar>\r\n              <div>\r\n                <MessageBubble isUser={message.isUser}>\r\n                  {message.isUser ? (\r\n                    message.text\r\n                  ) : (\r\n                    <FormattedMessage \r\n                      dangerouslySetInnerHTML={{ \r\n                        __html: formatBotResponse(message.text) \r\n                      }} \r\n                    />\r\n                  )}\r\n                </MessageBubble>\r\n                <MessageTime isUser={message.isUser}>\r\n                  {formatTime(message.timestamp)}\r\n                </MessageTime>\r\n              </div>\r\n            </Message>\r\n          ))\r\n        )}\r\n        \r\n        {isLoading && (\r\n          <Message isUser={false}>\r\n            <Avatar isUser={false}>\r\n              <FiMessageCircle />\r\n            </Avatar>\r\n            <TypingIndicator>\r\n              <span>AI is thinking</span>\r\n              <div className=\"dots\">\r\n                <div className=\"dot\"></div>\r\n                <div className=\"dot\"></div>\r\n                <div className=\"dot\"></div>\r\n              </div>\r\n            </TypingIndicator>\r\n          </Message>\r\n        )}\r\n        \r\n        <div ref={messagesEndRef} />\r\n      </MessagesContainer>\r\n\r\n      {error && (\r\n        <ErrorMessage>\r\n          <FiAlertCircle />\r\n          {error}\r\n        </ErrorMessage>\r\n      )}\r\n\r\n      <InputContainer>\r\n        <MessageInput\r\n          ref={inputRef}\r\n          value={inputValue}\r\n          onChange={handleInputChange}\r\n          onKeyPress={handleKeyPress}\r\n          placeholder=\"Ask me anything about farming...\"\r\n          disabled={isLoading}\r\n          rows=\"1\"\r\n        />\r\n        <SendButton\r\n          onClick={() => sendMessage()}\r\n          disabled={!inputValue.trim() || isLoading}\r\n        >\r\n          <FiSend size={16} />\r\n        </SendButton>\r\n      </InputContainer>\r\n    </ChatContainer>\r\n  );\r\n}\r\n\r\nexport default ChatInterface;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AAC1D,OAAOC,MAAM,MAAM,mBAAmB;AACtC,SAASC,MAAM,EAAEC,MAAM,EAAEC,eAAe,EAAEC,aAAa,QAAQ,gBAAgB;AAC/E,SAASC,WAAW,QAAQ,yBAAyB;AACrD,SAASC,WAAW,QAAQ,yBAAyB;AACrD,SAASC,kBAAkB,QAAQ,gCAAgC;AACnE,SAASC,EAAE,IAAIC,MAAM,QAAQ,MAAM;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEpC,MAAMC,aAAa,GAAGZ,MAAM,CAACa,GAAG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,aAAaC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE;AAC5C;AACA,CAAC;AAACC,EAAA,GATIN,aAAa;AAWnB,MAAMO,iBAAiB,GAAGnB,MAAM,CAACa,GAAG;AACpC;AACA;AACA,aAAaC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AAC5C;AACA;AACA,SAASN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AACxC;AACA,CAAC;AAACC,GAAA,GARIF,iBAAiB;AAUvB,MAAMG,OAAO,GAAGtB,MAAM,CAACa,GAAG;AAC1B;AACA,SAASC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AACxC;AACA,aAAaN,KAAK,IAAIA,KAAK,CAACS,KAAK,GAAG,CAAC,GAAG,CAAC;AACzC,eAAeT,KAAK,IAAIA,KAAK,CAACS,KAAK,GAAG,+BAA+B,GAAG,MAAM;AAC9E;AACA,mBAAmBT,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACQ,EAAE;AAClD;AACA,IAAIV,KAAK,IAAIA,KAAK,CAACW,MAAM,IAAI;AAC7B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,GAAA,GAlBIJ,OAAO;AAoBb,MAAMK,MAAM,GAAG3B,MAAM,CAACa,GAAG;AACzB;AACA;AACA,mBAAmBC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACa,YAAY,CAACC,IAAI;AACzD;AACA;AACA;AACA;AACA;AACA,eAAef,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAACV,EAAE;AAChD;AACA,oBAAoBN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACgB,WAAW,CAACC,IAAI;AACzD;AACA,IAAIlB,KAAK,IAAIA,KAAK,CAACW,MAAM,GAAG;AAC5B,kBAAkBX,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACC,eAAe;AACpD;AACA,GAAG,GAAG;AACN,kBAAkBpB,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACE,cAAc;AACnD;AACA,GAAG;AACH;AACA;AACA;AACA,MAAMrB,KAAK,IAAIA,KAAK,CAACW,MAAM,GAAG;AAC9B;AACA,KAAK,GAAG;AACR;AACA,KAAK;AACL;AACA,CAAC;AAACW,GAAA,GA7BIT,MAAM;AA+BZ,MAAMU,aAAa,GAAGrC,MAAM,CAACa,GAAG;AAChC;AACA;AACA,aAAaC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE,IAAIN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE;AAC/E,mBAAmBH,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACa,YAAY,CAACU,EAAE;AACvD,eAAexB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAACS,IAAI;AAClD;AACA;AACA;AACA;AACA,oBAAoBzB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACgB,WAAW,CAACC,IAAI;AACzD;AACA,IAAIlB,KAAK,IAAIA,KAAK,CAACW,MAAM,GAAG;AAC5B,kBAAkBX,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACC,eAAe;AACpD;AACA,oBAAoBpB,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACO,YAAY;AACnD,kCAAkC1B,KAAK,CAACC,KAAK,CAACa,YAAY,CAACR,EAAE;AAC7D;AACA,GAAG,GAAG;AACN,kBAAkBN,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACQ,eAAe;AACpD,aAAa3B,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACS,IAAI;AACpC,oBAAoB5B,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACU,WAAW;AAClD,iCAAiC7B,KAAK,CAACC,KAAK,CAACa,YAAY,CAACR,EAAE;AAC5D;AACA,GAAG;AACH;AACA;AACA;AACA,MAAMN,KAAK,IAAIA,KAAK,CAACW,MAAM,GAAG;AAC9B;AACA,KAAK,GAAG;AACR;AACA,KAAK;AACL;AACA,CAAC;AAACmB,GAAA,GAlCIP,aAAa;AAoCnB,MAAMQ,gBAAgB,GAAG7C,MAAM,CAACa,GAAG;AACnC;AACA;AACA;AACA;AACA,iBAAiBC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAACQ,EAAE;AAClD,cAAcxB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE,MAAMH,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AAClF,aAAaN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACa,OAAO;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiBhC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAACS,IAAI;AACpD,cAAczB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE,MAAMN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACQ,EAAE;AAClF,aAAaV,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACc,aAAa;AACtD;AACA;AACA;AACA,cAAcjC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACQ,EAAE;AAC7C,oBAAoBV,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACsB,EAAE;AACnD;AACA;AACA,uBAAuBxB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACQ,EAAE;AACtD;AACA;AACA;AACA;AACA;AACA,cAAcV,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAaN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACa,OAAO;AAChD;AACA;AACA;AACA,qBAAqBhC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE;AACpD;AACA;AACA;AACA;AACA;AACA,CAAC;AAAC+B,GAAA,GAvDIH,gBAAgB;AAyDtB,MAAMI,WAAW,GAAGjD,MAAM,CAACa,GAAG;AAC9B,eAAeC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAACN,EAAE;AAChD,WAAWV,KAAK,IAAIA,KAAK,CAACW,MAAM,GAAG,uBAAuB,GAAGX,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACc,aAAa;AAC7F,gBAAgBjC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACQ,EAAE;AAC/C,CAAC;AAAC0B,GAAA,GAJID,WAAW;AAMjB,MAAME,cAAc,GAAGnD,MAAM,CAACa,GAAG;AACjC;AACA,SAASC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AACxC,aAAaN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE;AAC5C,gBAAgBH,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACQ,eAAe;AAC3D,mBAAmB3B,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACa,YAAY,CAACU,EAAE;AACvD,sBAAsBxB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACU,WAAW;AAC7D,gBAAgB7B,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE;AAC/C;AACA,oBAAoBH,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACgB,WAAW,CAACC,IAAI;AACzD;AACA;AACA,oBAAoBlB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACmB,MAAM;AACtD;AACA;AACA;AACA,CAAC;AAACC,GAAA,GAhBIF,cAAc;AAkBpB,MAAMG,YAAY,GAAGtD,MAAM,CAACuD,QAAQ;AACpC;AACA;AACA;AACA,eAAezC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAACS,IAAI;AAClD;AACA,WAAWzB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACS,IAAI;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,aAAa5B,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACc,aAAa;AACtD;AACA,CAAC;AAACS,GAAA,GAfIF,YAAY;AAiBlB,MAAMG,UAAU,GAAGzD,MAAM,CAAC0D,MAAM;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB5C,KAAK,IAAIA,KAAK,CAAC6C,QAAQ,GACnC7C,KAAK,CAACC,KAAK,CAACkB,MAAM,CAAC2B,WAAW,GAC9B9C,KAAK,CAACC,KAAK,CAACkB,MAAM,CAAC4B,iBAAiB;AACxC;AACA,mBAAmB/C,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACa,YAAY,CAACU,EAAE;AACvD,YAAYxB,KAAK,IAAIA,KAAK,CAAC6C,QAAQ,GAAG,aAAa,GAAG,SAAS;AAC/D,oBAAoB7C,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACgB,WAAW,CAACC,IAAI;AACzD;AACA;AACA;AACA,kBAAkBlB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAAC6B,aAAa;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,GAAA,GAzBIN,UAAU;AA2BhB,MAAMO,eAAe,GAAGhE,MAAM,CAACa,GAAG;AAClC;AACA,SAASC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AACxC;AACA,aAAaN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE;AAC5C,gBAAgBH,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACgC,OAAO;AACnD,sBAAsBnD,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACiC,MAAM;AACxD,mBAAmBpD,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACa,YAAY,CAACU,EAAE;AACvD,+BAA+BxB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACa,YAAY,CAACR,EAAE;AACnE,WAAWN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACc,aAAa;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkBjC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACc,aAAa;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACoB,GAAA,GA3BIH,eAAe;AA6BrB,MAAMI,YAAY,GAAGpE,MAAM,CAACa,GAAG;AAC/B;AACA;AACA,SAASC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AACxC,aAAaN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE;AAC5C,gBAAgBH,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACoC,KAAK;AACjD,sBAAsBvD,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACoC,KAAK;AACvD,mBAAmBvD,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACa,YAAY,CAACX,EAAE;AACvD,WAAWH,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACoC,KAAK;AAC5C,eAAevD,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAACV,EAAE;AAChD,gBAAgBN,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AAC/C,CAAC;AAACkD,IAAA,GAXIF,YAAY;AAalB,MAAMG,cAAc,GAAGvE,MAAM,CAACa,GAAG;AACjC;AACA,aAAaC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACwD,EAAE;AAC5C,WAAW1D,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACc,aAAa;AACpD,gBAAgBjC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACQ,eAAe;AAC3D,mBAAmB3B,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACa,YAAY,CAAC4C,EAAE;AACvD,YAAY1D,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACsB,EAAE;AAC3C,gBAAgBxB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACwC,UAAU;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB3D,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACE,cAAc;AAC5D;AACA;AACA;AACA,iBAAiBrB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAAC,KAAK,CAAC;AACtD,kBAAkBhB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACC,eAAe;AAC7D;AACA;AACA;AACA,qBAAqBpB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE;AACpD,mBAAmBH,KAAK,IAAIA,KAAK,CAACC,KAAK,CAAC2D,WAAW,CAACC,IAAI;AACxD;AACA;AACA,eAAe7D,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACa,OAAO;AAClD;AACA;AACA;AACA;AACA,iBAAiBhC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAACQ,EAAE;AAClD,qBAAqBxB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACsB,EAAE;AACpD,aAAaxB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACc,aAAa;AACtD;AACA;AACA;AACA;AACA;AACA,WAAWjC,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACI,EAAE;AAC1C;AACA;AACA;AACA,CAAC;AAACwD,IAAA,GAhDIL,cAAc;AAkDpB,MAAMM,YAAY,GAAG7E,MAAM,CAAC0D,MAAM;AAClC,aAAa5C,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACC,EAAE,IAAIH,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACC,OAAO,CAACsB,EAAE;AAC/E;AACA,gBAAgBxB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACQ,eAAe;AAC3D,mBAAmB3B,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACa,YAAY,CAACU,EAAE;AACvD,WAAWxB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACS,IAAI;AAC3C;AACA,eAAe5B,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACe,SAAS,CAACS,IAAI;AAClD,iBAAiBzB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAAC2D,WAAW,CAACI,MAAM;AACxD,oBAAoBhE,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACgB,WAAW,CAACC,IAAI;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkBlB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACE,cAAc;AAC5D,uBAAuBrB,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACgB,WAAW,CAACgD,MAAM;AAC9D;AACA;AACA;AACA;AACA,oBAAoBjE,KAAK,IAAIA,KAAK,CAACC,KAAK,CAACkB,MAAM,CAACmB,MAAM;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AAAA4B,IAAA,GAtCMH,YAAY;AAuClB,MAAMI,iBAAiB,GAAIvC,IAAI,IAAK;EAClC,IAAI,CAACA,IAAI,EAAE,OAAOA,IAAI;EAEtB,IAAIwC,SAAS,GAAGxC,IAAI;;EAEpB;EACAwC,SAAS,GAAGA,SAAS,CAACC,OAAO,CAAC,oBAAoB,EAAE,cAAc,CAAC;;EAEnE;EACAD,SAAS,GAAGA,SAAS,CAACC,OAAO,CAAC,kBAAkB,EAAE,qBAAqB,CAAC;;EAExE;EACA,MAAMC,KAAK,GAAGF,SAAS,CAACG,KAAK,CAAC,IAAI,CAAC,CAACC,MAAM,CAACC,IAAI,IAAIA,IAAI,CAACC,IAAI,CAAC,CAAC,CAAC;EAC/D,IAAIC,MAAM,GAAG,EAAE;EACf,IAAIC,WAAW,GAAG,EAAE;EAEpBN,KAAK,CAACO,OAAO,CAAC,CAACJ,IAAI,EAAEK,KAAK,KAAK;IAC7B,MAAMC,OAAO,GAAGN,IAAI,CAACC,IAAI,CAAC,CAAC;;IAE3B;IACA,IAAIK,OAAO,CAACC,QAAQ,CAAC,MAAM,CAAC,EAAE;MAC5B;MACA,IAAIJ,WAAW,CAACK,MAAM,GAAG,CAAC,EAAE;QAC1BN,MAAM,CAACO,IAAI,CAAC,OAAON,WAAW,CAACO,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC;QAC/CP,WAAW,GAAG,EAAE;MAClB;MACAD,MAAM,CAACO,IAAI,CAAC,wBAAwBH,OAAO,QAAQ,CAAC;MACpD;IACF;;IAEA;IACA,IAAI,WAAW,CAACK,IAAI,CAACL,OAAO,CAAC,EAAE;MAC7B,MAAMM,OAAO,GAAGN,OAAO,CAACV,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC;MAChDO,WAAW,CAACM,IAAI,CAAC,OAAOG,OAAO,OAAO,CAAC;MACvC;IACF;;IAEA;IACA,IAAIN,OAAO,CAACO,UAAU,CAAC,GAAG,CAAC,IAAIP,OAAO,CAACO,UAAU,CAAC,GAAG,CAAC,IAAIP,OAAO,CAACO,UAAU,CAAC,GAAG,CAAC,EAAE;MACjF,MAAMD,OAAO,GAAGN,OAAO,CAACQ,SAAS,CAAC,CAAC,CAAC,CAACb,IAAI,CAAC,CAAC;MAC3CE,WAAW,CAACM,IAAI,CAAC,OAAOG,OAAO,OAAO,CAAC;MACvC;IACF;;IAEA;IACA,IAAIN,OAAO,EAAE;MACX;MACA,IAAIH,WAAW,CAACK,MAAM,GAAG,CAAC,EAAE;QAC1BN,MAAM,CAACO,IAAI,CAAC,OAAON,WAAW,CAACO,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC;QAC/CP,WAAW,GAAG,EAAE;MAClB;MACAD,MAAM,CAACO,IAAI,CAAC,MAAMH,OAAO,MAAM,CAAC;IAClC;EACF,CAAC,CAAC;;EAEF;EACA,IAAIH,WAAW,CAACK,MAAM,GAAG,CAAC,EAAE;IAC1BN,MAAM,CAACO,IAAI,CAAC,OAAON,WAAW,CAACO,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC;EACjD;EAEA,OAAOR,MAAM,CAACQ,IAAI,CAAC,EAAE,CAAC;AACxB,CAAC;AAED,SAASK,aAAaA,CAAC;EAAEC,eAAe,GAAG,EAAE;EAAEC,SAAS,EAAEC,aAAa;EAAEC;AAAiB,CAAC,EAAE;EAAAC,EAAA;EAC3F,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGhH,QAAQ,CAAC0G,eAAe,CAAC;EACzD,MAAM,CAACO,UAAU,EAAEC,aAAa,CAAC,GAAGlH,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAACmH,SAAS,EAAEC,YAAY,CAAC,GAAGpH,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACwE,KAAK,EAAE6C,QAAQ,CAAC,GAAGrH,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAAC2G,SAAS,CAAC,GAAG3G,QAAQ,CAAC,MAAM4G,aAAa,IAAIhG,MAAM,CAAC,CAAC,CAAC;EAC7D,MAAM,CAAC0G,WAAW,CAAC,GAAGtH,QAAQ,CAAC,MAAMS,WAAW,CAAC8G,cAAc,CAAC,CAAC,CAAC;EAClE,MAAMC,cAAc,GAAGvH,MAAM,CAAC,IAAI,CAAC;EACnC,MAAMwH,QAAQ,GAAGxH,MAAM,CAAC,IAAI,CAAC;;EAE7B;EACAC,SAAS,CAAC,MAAM;IACd8G,WAAW,CAACN,eAAe,CAAC;EAC9B,CAAC,EAAE,CAACA,eAAe,CAAC,CAAC;;EAErB;EACAxG,SAAS,CAAC,MAAM;IACd,IAAI2G,gBAAgB,EAAE;MACpBA,gBAAgB,CAACE,QAAQ,CAAC;IAC5B;EACF,CAAC,EAAE,CAACA,QAAQ,EAAEF,gBAAgB,CAAC,CAAC;;EAEhC;EACA3G,SAAS,CAAC,MAAM;IACd,IAAIwG,eAAe,CAACR,MAAM,KAAK,CAAC,EAAE;MAChC,MAAMwB,eAAe,GAAGA,CAAA,KAAM;QAC5B,IAAI;UACF,MAAMC,OAAO,GAAGjH,kBAAkB,CAACgH,eAAe,CAAC,CAAC;UACpD,IAAIC,OAAO,CAACzB,MAAM,GAAG,CAAC,EAAE;YACtBc,WAAW,CAACW,OAAO,CAAC;UACtB;QACF,CAAC,CAAC,OAAOnD,KAAK,EAAE;UACdoD,OAAO,CAACpD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;QACtD;MACF,CAAC;MAEDkD,eAAe,CAAC,CAAC;IACnB;EACF,CAAC,EAAE,CAAChB,eAAe,CAACR,MAAM,CAAC,CAAC;;EAE5B;EACAhG,SAAS,CAAC,MAAM;IACd,IAAI6G,QAAQ,CAACb,MAAM,GAAG,CAAC,EAAE;MACvBxF,kBAAkB,CAACmH,eAAe,CAACd,QAAQ,CAAC;IAC9C;EACF,CAAC,EAAE,CAACA,QAAQ,CAAC,CAAC;EAEd,MAAMe,cAAc,GAAGA,CAAA,KAAM;IAAA,IAAAC,qBAAA;IAC3B,CAAAA,qBAAA,GAAAP,cAAc,CAACQ,OAAO,cAAAD,qBAAA,uBAAtBA,qBAAA,CAAwBE,cAAc,CAAC;MAAEC,QAAQ,EAAE;IAAS,CAAC,CAAC;EAChE,CAAC;EAEDhI,SAAS,CAAC,MAAM;IACd4H,cAAc,CAAC,CAAC;EAClB,CAAC,EAAE,CAACf,QAAQ,CAAC,CAAC;EAEd,MAAMoB,UAAU,GAAIC,IAAI,IAAK;IAC3B,OAAO,IAAIC,IAAI,CAACC,cAAc,CAAC,OAAO,EAAE;MACtCC,IAAI,EAAE,SAAS;MACfC,MAAM,EAAE;IACV,CAAC,CAAC,CAACC,MAAM,CAACL,IAAI,CAAC;EACjB,CAAC;EAED,MAAMM,WAAW,GAAG,MAAAA,CAAOC,WAAW,GAAG1B,UAAU,CAACtB,IAAI,CAAC,CAAC,KAAK;IAC7D,IAAI,CAACgD,WAAW,IAAIxB,SAAS,EAAE;IAE/B,MAAMyB,WAAW,GAAG;MAClBC,EAAE,EAAEjI,MAAM,CAAC,CAAC;MACZiC,IAAI,EAAE8F,WAAW;MACjB/G,MAAM,EAAE,IAAI;MACZkH,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;MACrBrH,KAAK,EAAE;IACT,CAAC;IAEDsF,WAAW,CAACgC,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEJ,WAAW,CAAC,CAAC;IAC3C1B,aAAa,CAAC,EAAE,CAAC;IACjBE,YAAY,CAAC,IAAI,CAAC;IAClBC,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF,MAAM4B,QAAQ,GAAG,MAAMzI,WAAW,CAACkI,WAAW,CAACC,WAAW,EAAEhC,SAAS,EAAEW,WAAW,CAACuB,EAAE,CAAC;MAEtF,MAAMK,gBAAgB,GAAG;QACvBL,EAAE,EAAEjI,MAAM,CAAC,CAAC;QACZiC,IAAI,EAAEoG,QAAQ,CAACE,OAAO;QACtBvH,MAAM,EAAE,KAAK;QACbkH,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;QACrBK,IAAI,EAAEH,QAAQ,CAACG,IAAI;QACnB1H,KAAK,EAAE;MACT,CAAC;MAEDsF,WAAW,CAACgC,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEE,gBAAgB,CAAC,CAAC;IAClD,CAAC,CAAC,OAAOG,GAAG,EAAE;MACZzB,OAAO,CAACpD,KAAK,CAAC,aAAa,EAAE6E,GAAG,CAAC;MACjChC,QAAQ,CAACgC,GAAG,CAACF,OAAO,IAAI,wBAAwB,CAAC;IACnD,CAAC,SAAS;MACR/B,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;EAED,MAAMkC,cAAc,GAAIC,CAAC,IAAK;IAC5B,IAAIA,CAAC,CAACC,GAAG,KAAK,OAAO,IAAI,CAACD,CAAC,CAACE,QAAQ,EAAE;MACpCF,CAAC,CAACG,cAAc,CAAC,CAAC;MAClBhB,WAAW,CAAC,CAAC;IACf;EACF,CAAC;EAED,MAAMiB,iBAAiB,GAAIJ,CAAC,IAAK;IAC/BrC,aAAa,CAACqC,CAAC,CAACK,MAAM,CAACC,KAAK,CAAC;;IAE7B;IACAN,CAAC,CAACK,MAAM,CAACE,KAAK,CAACC,MAAM,GAAG,MAAM;IAC9BR,CAAC,CAACK,MAAM,CAACE,KAAK,CAACC,MAAM,GAAGR,CAAC,CAACK,MAAM,CAACI,YAAY,GAAG,IAAI;EACtD,CAAC;EAED,MAAMC,cAAc,GAAG,CACrB,yCAAyC,EACzC,yCAAyC,EACzC,yCAAyC,EACzC,gCAAgC,CACjC;EAED,oBACEnJ,OAAA,CAACC,aAAa;IAAAmJ,QAAA,gBACZpJ,OAAA,CAACQ,iBAAiB;MAAA4I,QAAA,GACfnD,QAAQ,CAACb,MAAM,KAAK,CAAC,gBACpBpF,OAAA,CAAC4D,cAAc;QAAAwF,QAAA,gBACbpJ,OAAA;UAAAoJ,QAAA,EAAI;QAA4B;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACrCxJ,OAAA;UAAAoJ,QAAA,EAAG;QAAiE;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACxExJ,OAAA;UAAKyJ,SAAS,EAAC,UAAU;UAAAL,QAAA,gBACvBpJ,OAAA;YAAAoJ,QAAA,EAAQ;UAAiB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,EACjCL,cAAc,CAACO,GAAG,CAAC,CAACC,KAAK,EAAE1E,KAAK,kBAC/BjF,OAAA,CAACkE,YAAY;YAEX0F,OAAO,EAAEA,CAAA,KAAMhC,WAAW,CAAC+B,KAAK,CAAE;YAAAP,QAAA,EAEjCO;UAAK,GAHD1E,KAAK;YAAAoE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAIE,CACf,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACQ,CAAC,GAEjBvD,QAAQ,CAACyD,GAAG,CAACrB,OAAO,iBAClBrI,OAAA,CAACW,OAAO;QAAkBG,MAAM,EAAEuH,OAAO,CAACvH,MAAO;QAACF,KAAK,EAAEyH,OAAO,CAACzH,KAAM;QAAAwI,QAAA,gBACrEpJ,OAAA,CAACgB,MAAM;UAACF,MAAM,EAAEuH,OAAO,CAACvH,MAAO;UAAAsI,QAAA,EAC5Bf,OAAO,CAACvH,MAAM,gBAAGd,OAAA,CAACT,MAAM;YAAA8J,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,gBAAGxJ,OAAA,CAACR,eAAe;YAAA6J,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5C,CAAC,eACTxJ,OAAA;UAAAoJ,QAAA,gBACEpJ,OAAA,CAAC0B,aAAa;YAACZ,MAAM,EAAEuH,OAAO,CAACvH,MAAO;YAAAsI,QAAA,EACnCf,OAAO,CAACvH,MAAM,GACbuH,OAAO,CAACtG,IAAI,gBAEZ/B,OAAA,CAACkC,gBAAgB;cACf2H,uBAAuB,EAAE;gBACvBC,MAAM,EAAExF,iBAAiB,CAAC+D,OAAO,CAACtG,IAAI;cACxC;YAAE;cAAAsH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH;UACF;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACY,CAAC,eAChBxJ,OAAA,CAACsC,WAAW;YAACxB,MAAM,EAAEuH,OAAO,CAACvH,MAAO;YAAAsI,QAAA,EACjC/B,UAAU,CAACgB,OAAO,CAACL,SAAS;UAAC;YAAAqB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACX,CAAC;MAAA,GAnBMnB,OAAO,CAACN,EAAE;QAAAsB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAoBf,CACV,CACF,EAEAnD,SAAS,iBACRrG,OAAA,CAACW,OAAO;QAACG,MAAM,EAAE,KAAM;QAAAsI,QAAA,gBACrBpJ,OAAA,CAACgB,MAAM;UAACF,MAAM,EAAE,KAAM;UAAAsI,QAAA,eACpBpJ,OAAA,CAACR,eAAe;YAAA6J,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACb,CAAC,eACTxJ,OAAA,CAACqD,eAAe;UAAA+F,QAAA,gBACdpJ,OAAA;YAAAoJ,QAAA,EAAM;UAAc;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC3BxJ,OAAA;YAAKyJ,SAAS,EAAC,MAAM;YAAAL,QAAA,gBACnBpJ,OAAA;cAAKyJ,SAAS,EAAC;YAAK;cAAAJ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC3BxJ,OAAA;cAAKyJ,SAAS,EAAC;YAAK;cAAAJ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC3BxJ,OAAA;cAAKyJ,SAAS,EAAC;YAAK;cAAAJ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACxB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACS,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACX,CACV,eAEDxJ,OAAA;QAAK+J,GAAG,EAAErD;MAAe;QAAA2C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACX,CAAC,EAEnB9F,KAAK,iBACJ1D,OAAA,CAACyD,YAAY;MAAA2F,QAAA,gBACXpJ,OAAA,CAACP,aAAa;QAAA4J,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,EAChB9F,KAAK;IAAA;MAAA2F,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACM,CACf,eAEDxJ,OAAA,CAACwC,cAAc;MAAA4G,QAAA,gBACbpJ,OAAA,CAAC2C,YAAY;QACXoH,GAAG,EAAEpD,QAAS;QACdoC,KAAK,EAAE5C,UAAW;QAClB6D,QAAQ,EAAEnB,iBAAkB;QAC5BoB,UAAU,EAAEzB,cAAe;QAC3B0B,WAAW,EAAC,kCAAkC;QAC9ClH,QAAQ,EAAEqD,SAAU;QACpB8D,IAAI,EAAC;MAAG;QAAAd,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACT,CAAC,eACFxJ,OAAA,CAAC8C,UAAU;QACT8G,OAAO,EAAEA,CAAA,KAAMhC,WAAW,CAAC,CAAE;QAC7B5E,QAAQ,EAAE,CAACmD,UAAU,CAACtB,IAAI,CAAC,CAAC,IAAIwB,SAAU;QAAA+C,QAAA,eAE1CpJ,OAAA,CAACV,MAAM;UAAC8K,IAAI,EAAE;QAAG;UAAAf,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACV,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACJ,CAAC;AAEpB;AAACxD,EAAA,CAnNQL,aAAa;AAAA0E,IAAA,GAAb1E,aAAa;AAqNtB,eAAeA,aAAa;AAAC,IAAApF,EAAA,EAAAG,GAAA,EAAAK,GAAA,EAAAU,GAAA,EAAAQ,GAAA,EAAAI,GAAA,EAAAE,GAAA,EAAAG,GAAA,EAAAG,GAAA,EAAAO,GAAA,EAAAI,GAAA,EAAAG,IAAA,EAAAM,IAAA,EAAAI,IAAA,EAAAgG,IAAA;AAAAC,YAAA,CAAA/J,EAAA;AAAA+J,YAAA,CAAA5J,GAAA;AAAA4J,YAAA,CAAAvJ,GAAA;AAAAuJ,YAAA,CAAA7I,GAAA;AAAA6I,YAAA,CAAArI,GAAA;AAAAqI,YAAA,CAAAjI,GAAA;AAAAiI,YAAA,CAAA/H,GAAA;AAAA+H,YAAA,CAAA5H,GAAA;AAAA4H,YAAA,CAAAzH,GAAA;AAAAyH,YAAA,CAAAlH,GAAA;AAAAkH,YAAA,CAAA9G,GAAA;AAAA8G,YAAA,CAAA3G,IAAA;AAAA2G,YAAA,CAAArG,IAAA;AAAAqG,YAAA,CAAAjG,IAAA;AAAAiG,YAAA,CAAAD,IAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}